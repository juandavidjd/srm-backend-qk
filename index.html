<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Suite Ejecutiva Digital - Somos Repuestos Motos</title>

  <!-- FAVICONS / MANIFEST (rutas absolutas para GitHub Pages /QK/) -->
  <link rel="icon" href="/QK/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="/QK/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/QK/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/QK/apple-touch-icon.png">
  <link rel="manifest" href="/QK/site.webmanifest">
  <meta name="theme-color" content="#0A2F7B" />

  <!-- SEO -->
  <meta name="description" content="Explora la propuesta estratégica de la Suite Ejecutiva Digital: innovación, marca y crecimiento para el futuro de Somos Repuestos Motos.">
  <meta name="author" content="Somos Repuestos Motos - Coder">

  <!-- OPEN GRAPH -->
  <meta property="og:title" content="Suite Ejecutiva Digital - Somos Repuestos Motos">
  <meta property="og:description" content="Estrategia, tecnología y visión: el futuro digital de Somos Repuestos Motos.">
  <meta property="og:image" content="https://somosrepuestosmotos-coder.github.io/QK/android-chrome-512x512.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="512">
  <meta property="og:image:height" content="512">
  <meta property="og:url" content="https://somosrepuestosmotos-coder.github.io/QK/">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="es_ES">

  <!-- TWITTER -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Suite Ejecutiva Digital - Somos Repuestos Motos">
  <meta name="twitter:description" content="Explora la estrategia visual y digital que impulsa el crecimiento.">
  <meta name="twitter:image" content="https://somosrepuestosmotos-coder.github.io/QK/android-chrome-512x512.png">

  <style>
    :root {
      --primary-color: #0A2F7B;
      --secondary-color: #00B6C8;
      --text-color: #FFFFFF;
    }

    * { box-sizing: border-box; }
    html, body {
      margin: 0; padding: 0; width: 100%; height: 100%;
      background: #000; color: var(--text-color);
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      overflow: hidden;
    }

    /* Escenas */
    .scene {
      position: absolute; inset: 0;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      text-align: center;
      opacity: 0; transition: opacity 1.2s ease-in-out;
    }
    .scene.active { opacity: 1; z-index: 2; }

    /* Video de fondo */
    .scene-video {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 100%; height: 100%; object-fit: cover;
      background: #000; z-index: -2;
    }

    /* Overlay */
    .scene-overlay {
      position: absolute; inset: 0;
      background: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.35));
      z-index: -1;
    }

    /* Texto */
    .scene-content {
      opacity: 0; transform: translateY(24px);
      transition: opacity .9s ease-out, transform .9s ease-out;
      padding: 2rem; max-width: 1200px;
    }
    .scene.active .scene-content.visible { opacity: 1; transform: translateY(0); }
    .scene h1 {
      font-size: 3.8vw; line-height: 1.1; margin: 0 0 1.2vw;
      text-shadow: 2px 2px 8px rgba(0,0,0,.8);
      letter-spacing: .02em; font-weight: 700;
    }
    .scene p {
      font-size: 1.9vw; line-height: 1.6; margin: 0 auto;
      max-width: 55%; font-weight: 300; text-align: justify;
      text-shadow: 1px 1px 6px rgba(0,0,0,.8);
    }

    /* Formulario */
    #form-container {
      position: fixed; inset: 0; display: none;
      justify-content: center; align-items: center;
      background: rgba(0,0,0,.8); backdrop-filter: blur(10px);
      z-index: 100;
    }
    .form-content { width: 92%; max-width: 820px; }
    #progress-bar-container {
      width: 100%; background: #444; border-radius: 6px;
      overflow: hidden; margin-bottom: 24px;
    }
    #progress-bar { height: 10px; width: 0%; background: var(--secondary-color); transition: width .4s ease-out; }

    .question-card {
      display: none; background: #2c2c2c; border-radius: 14px;
      padding: 36px; box-shadow: 0 10px 30px rgba(0,0,0,.5);
      animation: fadeIn .4s ease forwards;
    }
    .question-card.active { display: block; }
    @keyframes fadeIn { from {opacity: 0} to {opacity: 1} }

    .answers { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-top: 18px; }
    .answer-btn {
      border: 1px solid #555; background: #3e3e3e; color: #fff;
      padding: 14px 18px; border-radius: 10px;
      cursor: pointer; font-size: 1rem; transition: transform .15s, background .25s;
    }
    .answer-btn:hover { background: var(--secondary-color); transform: translateY(-2px); }

    @media (max-width: 768px) {
      .scene h1 { font-size: 6vw; }
      .scene p { font-size: 3.5vw; max-width: 92%; }
      .answers { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<main id="presentation-container">
  <!-- Escena 1 -->
  <div class="scene active" id="scene-1">
    <div class="scene-overlay"></div>
    <video class="scene-video" autoplay muted playsinline preload="auto" crossorigin="anonymous">
      <source src="https://srm-backend-qk-lwid.onrender.com/videos/animacion-logo-qk-original.mp4" type="video/mp4">
    </video>
    <div class="scene-content">
      <h1>Comenzamos por entender el corazón de su negocio.</h1>
      <p>Analizamos su situación actual, su catálogo y su posición en el mercado. Vimos la base de un líder.</p>
    </div>
  </div>

  <!-- Escena 2 -->
  <div class="scene" id="scene-2">
    <div class="scene-overlay"></div>
    <video class="scene-video" autoplay muted playsinline preload="auto" crossorigin="anonymous">
      <source src="https://srm-backend-qk-lwid.onrender.com/videos/animacion-insight-mercado.mp4" type="video/mp4">
    </video>
    <div class="scene-content">
      <h1>Pero descubrimos una oportunidad que sus competidores no ven.</h1>
      <p>Su verdadero potencial no está solo en la calidad de sus piezas, sino en la construcción de una marca que inspire confianza inmediata a nivel digital.</p>
    </div>
  </div>

  <!-- Escena 3 -->
  <div class="scene" id="scene-3">
    <div class="scene-overlay"></div>
    <video class="scene-video" autoplay muted playsinline preload="auto" crossorigin="anonymous">
      <source src="https://srm-backend-qk-lwid.onrender.com/videos/animacion-nuevo-logo-3d.mp4" type="video/mp4">
    </video>
    <div class="scene-content">
      <h1>Visualizamos su marca, no como es, sino como debería ser.</h1>
      <p>Una identidad visual que comunica potencia, confianza y liderazgo tecnológico en cada punto de contacto.</p>
    </div>
  </div>

  <!-- Escena 4 -->
  <div class="scene" id="scene-4">
    <div class="scene-overlay"></div>
    <video class="scene-video" autoplay muted playsinline preload="auto" crossorigin="anonymous">
      <source src="https://srm-backend-qk-lwid.onrender.com/videos/animacion-papeleria-merchandising-packaging.mp4" type="video/mp4">
    </video>
    <div class="scene-content">
      <h1>Una marca que cobra vida en el mundo real.</h1>
      <p>Desde la primera tarjeta de presentación hasta el empaque de cada producto, su nueva identidad proyecta calidad y confianza.</p>
    </div>
  </div>

  <!-- Escena 5 -->
  <div class="scene" id="scene-5">
    <div class="scene-overlay"></div>
    <video class="scene-video" autoplay muted playsinline preload="auto" crossorigin="anonymous">
      <source src="https://srm-backend-qk-lwid.onrender.com/videos/animacion-ecosistema-digital.mp4" type="video/mp4">
    </video>
    <div class="scene-content">
      <h1>Más que una nueva imagen, un sistema diseñado para crecer.</h1>
      <p>Hemos estructurado una estrategia completa que transforma su experiencia en un motor de ventas predecible y automatizado.</p>
    </div>
  </div>

  <!-- Escena 6 -->
  <div class="scene" id="scene-6">
    <div class="scene-overlay"></div>
    <video class="scene-video" autoplay muted playsinline preload="auto" crossorigin="anonymous">
      <source src="https://srm-backend-qk-lwid.onrender.com/videos/animacion-srm-qk-k.mp4" type="video/mp4">
    </video>
    <div class="scene-content">
      <h1>Hemos construido el 90% del camino. El 10% final lo diseñamos juntos.</h1>
      <p>Esta visión estratégica necesita ser ajustada a sus objetivos específicos. Su conocimiento es la pieza clave para personalizar el Plan Piloto.</p>
    </div>
  </div>
</main>

<!-- Formulario -->
<div id="form-container">
  <div class="form-content">
    <div id="progress-bar-container"><div id="progress-bar"></div></div>
    <div id="questions-wrapper"></div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const scenes = Array.from(document.querySelectorAll('.scene'));
  const container = document.getElementById('presentation-container');
  let currentSceneIndex = 0;

  const formContainer = document.getElementById('form-container');
  const questionsWrapper = document.getElementById('questions-wrapper');
  const progressBar = document.getElementById('progress-bar');

  const sessionId = `session_${Date.now()}_${Math.random().toString(36).slice(2,11)}`;
  let currentQuestionIndex = 0;

  const questions = [
    { key: 'main_objective_6m', text: '¿Cuál es su objetivo principal para los próximos 6 meses?', answers: ['Aumentar ventas B2B', 'Expandir a nuevas regiones', 'Mejorar la rentabilidad', 'Fortalecer la marca'] },
    { key: 'biggest_challenge', text: '¿Cuál considera su mayor desafío actualmente?', answers: ['Competencia de precios', 'Logística y entregas', 'Fidelización de clientes', 'Digitalización de procesos'] },
    { key: 'investment_priority', text: '¿En qué área priorizaría la inversión?', answers: ['Marketing y Publicidad', 'Tecnología (E-commerce, CRM)', 'Inventario y Stock', 'Capacitación de equipo'] },
    { key: 'start_timeline', text: '¿Cuál es su cronograma ideal para iniciar este plan piloto?', answers: ['Inmediatamente', 'En el próximo mes', 'En el próximo trimestre', 'Aún por definir'] }
  ];

  function showTextFor(scene) {
    const content = scene.querySelector('.scene-content');
    setTimeout(() => content.classList.add('visible'), 800);
  }

  function goToScene(nextIndex) {
    if (nextIndex >= scenes.length) return showForm();
    scenes.forEach(s => s.classList.remove('active'));
    const next = scenes[nextIndex];
    next.classList.add('active');
    const v = next.querySelector('video');
    if (v) {
      v.currentTime = 0;
      v.play().catch(()=>{ /* autoplay puede requerir interacción en algunos dispositivos */ });
      v.onended = () => goToScene(nextIndex + 1);
    }
    showTextFor(next);
    currentSceneIndex = nextIndex;
  }

  function showForm() {
    formContainer.style.display = 'flex';
    renderQuestion();
  }

  function renderQuestion() {
    questionsWrapper.innerHTML = '';
    if (currentQuestionIndex >= questions.length) return showThankYou();
    const q = questions[currentQuestionIndex];
    const card = document.createElement('div');
    card.className = 'question-card active';
    card.innerHTML = `
      <h2>${q.text}</h2>
      <div class="answers">
        ${q.answers.map(a => `<button class="answer-btn" data-key="${q.key}" data-value="${a}">${a}</button>`).join('')}
      </div>
    `;
    questionsWrapper.appendChild(card);
    document.querySelectorAll('.answer-btn').forEach(b => b.addEventListener('click', handleAnswer));
  }

  async function handleAnswer(e) {
    const key = e.target.dataset.key;
    const value = e.target.dataset.value;
    try {
      const res = await fetch("https://srm-backend-qk-lwid.onrender.com/api/responder", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ sessionId, key, value })
      });
      if (!res.ok) throw new Error("Servidor");
    } catch (err) {
      console.warn("No se pudo registrar la respuesta. Reintentará al siguiente clic.", err);
    } finally {
      currentQuestionIndex++;
      progressBar.style.width = `${(currentQuestionIndex / questions.length) * 100}%`;
      renderQuestion();
    }
  }

  function showThankYou() {
    questionsWrapper.innerHTML = `
      <div class="question-card active" style="text-align:center;">
        <h1>Gracias. Hemos recibido su diagnóstico.</h1>
        <p style="font-size:1.2rem;">Nuestro equipo ya está personalizando su Plan Piloto. Recibirá su hoja de ruta en 48h.</p>
      </div>
    `;
    progressBar.style.width = '100%';
  }

  // Inicio: forzar primera escena y su reproducción
  const firstScene = scenes[0];
  const firstVideo = firstScene.querySelector('video');
  showTextFor(firstScene);
  firstVideo?.play().catch(() => {
    // En caso de bloqueo de autoplay, el primer clic avanzará y disparará play
  });
  firstVideo.onended = () => goToScene(1);

  // Permitir avanzar con clic
  container.addEventListener('click', () => {
    if (currentSceneIndex === scenes.length - 1) showForm();
    else goToScene(currentSceneIndex + 1);
  });
});
</script>

<!-- Registro del Service Worker (versión lite) -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/QK/service-worker-lite.js', { scope: '/QK/' })
      .then(reg => console.log('✅ SW registrado:', reg.scope))
      .catch(err => console.error('❌ Error SW:', err));
  });
}
</script>

</body>
</html>
